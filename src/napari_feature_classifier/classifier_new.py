# %%
# FIXME: Get rid of show_info in classifier class
import random
import string
from itertools import chain
from typing import Sequence
from zlib import crc32

import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import pandera as pa
import pydantic
import seaborn as sns
import xxhash
from napari.utils.notifications import show_info
from pandera.api.pandas.model import DataFrameModel
from pandera.typing import DataFrame, Index, Series


def join_index_columns(df: pd.DataFrame, index_columns: Sequence[str]) -> pd.Series:
    return (
        df.reset_index()
        .loc[:, list(index_columns)]
        .apply(lambda x: "_".join(map(str, x)), axis=1)
    ).rename("object_id")


def hash_single_object_id(object_id: str) -> float:
    max_value = 2**32
    return xxhash.xxh32(object_id).intdigest() / max_value


def get_normalized_hash_column(
    df: pd.DataFrame, index_columns: Sequence[str] = ("roi_id", "label")
) -> pd.Series:
    return join_index_columns(df, index_columns=index_columns).apply(
        hash_single_object_id
    )


def get_random_object_id(n_chars=10):
    return "".join(random.choice(string.ascii_lowercase) for i in range(n_chars))


def test_hash_function_leads_to_uniform_distribution():
    n = 80
    n_sites = 4
    n_per_site = n // n_sites
    site_ids = [
        e
        for e in chain.from_iterable(
            [[f"site{j}_{i}" for i in range(n_per_site)] for j in range(n_sites)]
        )
    ]
    random_ids = [get_random_object_id() for _ in range(n)]
    df1 = pd.Series(data=site_ids)
    df2 = pd.Series(data=random_ids)
    hash1 = df1.apply(hash_single_object_id)
    hash2 = df2.apply(hash_single_object_id)

    fig, ax = plt.subplots()
    sns.histplot(hash1, ax=ax)
    sns.histplot(hash2, ax=ax)


# %%
# TODO: This is cursed, annotations is supposed to be a nullable pandas int type but
# those don't seem to be recognized by pa.Check(ignore_na=True) when doing the checks :(
def get_input_and_internal_schemas(
    feature_names: Sequence[str],
    class_names: Sequence[str],
    index_columns: Sequence[str] = ("roi_id", "label"),
) -> tuple[pa.DataFrameSchema, pa.DataFrameSchema]:
    assert len(index_columns) == 2
    input_schema = pa.DataFrameSchema(
        columns={
            index_columns[0]: pa.Column(pa.String, coerce=True),
            index_columns[1]: pa.Column(pa.UInt64, coerce=True),
            "annotations": pa.Column(
                pa.Int64,
                coerce=True,
                # checks=pa.Check.between(1, len(class_names) + 1),
                checks=[
                    pa.Check(
                        lambda x: 1 <= x <= len(class_names),
                        element_wise=True,
                        ignore_na=True,
                    ),
                ],
                nullable=True,
            ),
            **{
                feature_name: pa.Column(pa.Float32, coerce=True)
                for feature_name in feature_names
            },
        },
        strict="filter",
        unique=list(index_columns),
    )

    internal_schema = input_schema.set_index(list(index_columns)).add_columns(
        {"hash": pa.Column(pa.Float32, coerce=True, checks=pa.Check.between(0.0, 1.0))}
    )
    return input_schema, internal_schema


# %%
index_columns = ["roi_id", "label"]
feature_names = ["f1", "f2"]
class_names = ["s", "m"]

input_schema, internal_schema = get_input_and_internal_schemas(
    feature_names,
    index_columns=index_columns,
    class_names=class_names,
)


# %%
n = 5
input_schema.validate(
    pd.DataFrame(
        {
            "roi_id": ["site1"] * n,
            "label": range(1, n + 1),
            "annotations": np.random.randint(1, len(class_names) + 1, size=n),
            "f1": np.random.randn(n),
            "f2": np.random.randn(n),
        }
    )
)
# %%


class Classifier:
    def __init__(self, feature_names, class_names):
        self._feature_names: list[str] = list(feature_names)
        self._class_names: list[str] = list(class_names)
        self._index_columns: list[str] = ["roi_id", "label"]
        self._input_schema, self._schema = get_input_and_internal_schemas(
            feature_names=feature_names,
            index_columns=self._index_columns,
            class_names=self._class_names,
        )
        # TODO: `self._schema.example(0)` does not return correct datatypes for
        # MultiIndex (issue: https://github.com/unionai-oss/pandera/issues/1049).
        # Can remove `self._schema.validate` call once fixed.
        self._data: pd.DataFrame = self._schema.validate(self._schema.example(0))

    def train(self):
        # TODO: Train the classifier
        show_info("Training classifier...")
        # TODO: Share training score

    def predict(self, df):
        # FIXME: Generate actual predictions for the df
        # FIXME: SettingWithCopyWarning => check if the actual run still
        # generates one, when we actually predict something
        with pd.option_context("mode.chained_assignment", None):
            df["predict"] = np.random.randint(1, 4, size=len(df))
        return df[["predict"]]

    def predict_on_dict(self, dict_of_dfs):
        # Make a prediction on each of the dataframes provided
        predicted_dicts = {}
        for roi in dict_of_dfs:
            show_info(f"Making a prediction for {roi=}...")
            predicted_dicts[roi] = self.predict(dict_of_dfs[roi])
        return predicted_dicts

    def add_features(self, df_raw: pd.DataFrame):
        # TODO: make sure objects with `annotation` == np.na get removed.
        show_info("Adding features...")
        #
        # Validate input
        df_valid_input = self._input_schema.validate(df_raw.reset_index())
        # Add hash column & set index
        df_valid_internal = df_valid_input.assign(
            hash=get_normalized_hash_column(df_valid_input, self._index_columns)
        ).set_index(self._index_columns)
        # Select index of rows not to be overwritten & update
        index = self._data.index.difference(df_valid_internal.index)
        self._data = pd.concat([self._data.loc[index], df_valid_internal]).sort_index()

    def get_class_names(self):
        return self._class_names

    def get_feature_names(self):
        return self._feature_names

    def save(self, output_path):
        # TODO: Implement saving
        show_info(f"Saving classifier at {output_path}...")


# %%
feature_names = ["feature1", "feature2", "feature3"]
class_names = ["s", "m"]
df_raw = pd.read_csv(
    r"C:\Users\hessm\Documents\Programming\Python\fractal-napari-plugins\napari-feature-classifier\src\napari_feature_classifier\sample_data\test_df_with_roi.csv"
).assign(feature3=1)
df_raw = (
    df_raw.assign(
        annotations=np.random.randint(1, len(class_names) + 1, size=len(df_raw))
    )
    .assign(is_train=np.random.randint(2, size=len(df_raw)))
    .astype({"annotations": "Int64"})
)
df_raw.annotations.loc[:3] = None

df = df_raw.set_index(["roi_id", "label"])
df2 = (
    (df_raw.set_index("roi_id") + 17)
    .reset_index()
    .set_index(["roi_id", "label"])
    .subtract(17)
)
df3 = df_raw.drop("roi_id", axis=1).assign(roi_id="site2")
# %%
c = Classifier(["feature1", "feature2", "feature3"], ["s", "m"])
print(c._data)
c.add_features(df)
print(c._data)
c.add_features(df2)
print(c._data)
# c.add_features(df * 2)
# print(c._data)
c.add_features(df3)
print(c._data)
# print((c._data.hash < 0.2).sum() / len(c._data))

# %%
error = {
    "name": "SchemaError",
    "message": 'Error while executing check function: TypeError("boolean value of NA is ambiguous")\nTraceback (most recent call last):\n  File "c:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\backends\\pandas\\components.py", line 191, in run_checks\n    self.run_check(\n  File "c:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\backends\\pandas\\base.py", line 95, in run_check\n    check_result = check(check_obj, *args)\n  File "c:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\api\\checks.py", line 230, in __call__\n    return backend(check_obj, column)\n  File "c:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\backends\\pandas\\checks.py", line 290, in __call__\n    check_output = self.apply(check_obj)\n  File "c:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\multimethod\\__init__.py", line 407, in __call__\n    return self[sig](*args, **kwargs)\n  File "c:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\backends\\pandas\\checks.py", line 137, in apply\n    return check_obj.map(self.check_fn)\n  File "c:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandas\\core\\series.py", line 4539, in map\n    new_values = self._map_values(arg, na_action=na_action)\n  File "c:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandas\\core\\base.py", line 890, in _map_values\n    new_values = map_f(values, mapper)\n  File "pandas\\_libs\\lib.pyx", line 2924, in pandas._libs.lib.map_infer\n  File "<ipython-input-2-33bc2c2059b3>", line 17, in <lambda>\n    lambda x: 1 <= x <= len(class_names),\n  File "pandas\\_libs\\missing.pyx", line 382, in pandas._libs.missing.NAType.__bool__\nTypeError: boolean value of NA is ambiguous\n',
    "stack": "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m\n\u001b[1;31mSchemaError\u001b[0m                               Traceback (most recent call last)\n\u001b[1;32mc:\\Users\\hessm\\Documents\\Programming\\Python\\fractal-napari-plugins\\napari-feature-classifier\\src\\napari_feature_classifier\\classifier_new.py\u001b[0m in \u001b[0;36mline 4\n\u001b[0;32m      <a href='file:///c%3A/Users/hessm/Documents/Programming/Python/fractal-napari-plugins/napari-feature-classifier/src/napari_feature_classifier/classifier_new.py?line=200'>201</a>\u001b[0m c \u001b[39m=\u001b[39m Classifier([\u001b[39m\"\u001b[39m\u001b[39mfeature1\u001b[39m\u001b[39m\"\u001b[39m, \u001b[39m\"\u001b[39m\u001b[39mfeature2\u001b[39m\u001b[39m\"\u001b[39m, \u001b[39m\"\u001b[39m\u001b[39mfeature3\u001b[39m\u001b[39m\"\u001b[39m], [\u001b[39m\"\u001b[39m\u001b[39ms\u001b[39m\u001b[39m\"\u001b[39m, \u001b[39m\"\u001b[39m\u001b[39mm\u001b[39m\u001b[39m\"\u001b[39m])\n\u001b[0;32m      <a href='file:///c%3A/Users/hessm/Documents/Programming/Python/fractal-napari-plugins/napari-feature-classifier/src/napari_feature_classifier/classifier_new.py?line=201'>202</a>\u001b[0m \u001b[39mprint\u001b[39m(c\u001b[39m.\u001b[39m_data)\n\u001b[1;32m----> <a href='file:///c%3A/Users/hessm/Documents/Programming/Python/fractal-napari-plugins/napari-feature-classifier/src/napari_feature_classifier/classifier_new.py?line=202'>203</a>\u001b[0m c\u001b[39m.\u001b[39;49madd_features(df)\n\u001b[0;32m      <a href='file:///c%3A/Users/hessm/Documents/Programming/Python/fractal-napari-plugins/napari-feature-classifier/src/napari_feature_classifier/classifier_new.py?line=203'>204</a>\u001b[0m \u001b[39mprint\u001b[39m(c\u001b[39m.\u001b[39m_data)\n\u001b[0;32m      <a href='file:///c%3A/Users/hessm/Documents/Programming/Python/fractal-napari-plugins/napari-feature-classifier/src/napari_feature_classifier/classifier_new.py?line=204'>205</a>\u001b[0m c\u001b[39m.\u001b[39madd_features(df2)\n\n\u001b[1;32mc:\\Users\\hessm\\Documents\\Programming\\Python\\fractal-napari-plugins\\napari-feature-classifier\\src\\napari_feature_classifier\\classifier_new.py\u001b[0m in \u001b[0;36mline 45\u001b[0m, in \u001b[0;36mClassifier.add_features\u001b[1;34m(self, df_raw)\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/Documents/Programming/Python/fractal-napari-plugins/napari-feature-classifier/src/napari_feature_classifier/classifier_new.py?line=153'>154</a>\u001b[0m show_info(\u001b[39m\"\u001b[39m\u001b[39mAdding features...\u001b[39m\u001b[39m\"\u001b[39m)\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/Documents/Programming/Python/fractal-napari-plugins/napari-feature-classifier/src/napari_feature_classifier/classifier_new.py?line=154'>155</a>\u001b[0m \u001b[39m#\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/Documents/Programming/Python/fractal-napari-plugins/napari-feature-classifier/src/napari_feature_classifier/classifier_new.py?line=155'>156</a>\u001b[0m \u001b[39m# Validate input\u001b[39;00m\n\u001b[1;32m---> <a href='file:///c%3A/Users/hessm/Documents/Programming/Python/fractal-napari-plugins/napari-feature-classifier/src/napari_feature_classifier/classifier_new.py?line=156'>157</a>\u001b[0m df_valid_input \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_input_schema\u001b[39m.\u001b[39;49mvalidate(df_raw\u001b[39m.\u001b[39;49mreset_index())\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/Documents/Programming/Python/fractal-napari-plugins/napari-feature-classifier/src/napari_feature_classifier/classifier_new.py?line=157'>158</a>\u001b[0m \u001b[39m# Add hash column & set index\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/Documents/Programming/Python/fractal-napari-plugins/napari-feature-classifier/src/napari_feature_classifier/classifier_new.py?line=158'>159</a>\u001b[0m df_valid_internal \u001b[39m=\u001b[39m df_valid_input\u001b[39m.\u001b[39massign(\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/Documents/Programming/Python/fractal-napari-plugins/napari-feature-classifier/src/napari_feature_classifier/classifier_new.py?line=159'>160</a>\u001b[0m     \u001b[39mhash\u001b[39m\u001b[39m=\u001b[39mget_normalized_hash_column(df_valid_input, \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_index_columns)\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/Documents/Programming/Python/fractal-napari-plugins/napari-feature-classifier/src/napari_feature_classifier/classifier_new.py?line=160'>161</a>\u001b[0m )\u001b[39m.\u001b[39mset_index(\u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_index_columns)\n\nFile \u001b[1;32mc:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\api\\pandas\\container.py:340\u001b[0m, in \u001b[0;36mDataFrameSchema.validate\u001b[1;34m(self, check_obj, head, tail, sample, random_state, lazy, inplace)\u001b[0m\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=327'>328</a>\u001b[0m     check_obj \u001b[39m=\u001b[39m check_obj\u001b[39m.\u001b[39mmap_partitions(  \u001b[39m# type: ignore [operator]\u001b[39;00m\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=328'>329</a>\u001b[0m         \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_validate,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=329'>330</a>\u001b[0m         head\u001b[39m=\u001b[39mhead,\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=335'>336</a>\u001b[0m         meta\u001b[39m=\u001b[39mcheck_obj,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=336'>337</a>\u001b[0m     )\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=337'>338</a>\u001b[0m     \u001b[39mreturn\u001b[39;00m check_obj\u001b[39m.\u001b[39mpandera\u001b[39m.\u001b[39madd_schema(\u001b[39mself\u001b[39m)\n\u001b[1;32m--> <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=339'>340</a>\u001b[0m \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_validate(\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=340'>341</a>\u001b[0m     check_obj\u001b[39m=\u001b[39;49mcheck_obj,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=341'>342</a>\u001b[0m     head\u001b[39m=\u001b[39;49mhead,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=342'>343</a>\u001b[0m     tail\u001b[39m=\u001b[39;49mtail,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=343'>344</a>\u001b[0m     sample\u001b[39m=\u001b[39;49msample,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=344'>345</a>\u001b[0m     random_state\u001b[39m=\u001b[39;49mrandom_state,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=345'>346</a>\u001b[0m     lazy\u001b[39m=\u001b[39;49mlazy,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=346'>347</a>\u001b[0m     inplace\u001b[39m=\u001b[39;49minplace,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=347'>348</a>\u001b[0m )\n\nFile \u001b[1;32mc:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\api\\pandas\\container.py:370\u001b[0m, in \u001b[0;36mDataFrameSchema._validate\u001b[1;34m(self, check_obj, head, tail, sample, random_state, lazy, inplace)\u001b[0m\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=360'>361</a>\u001b[0m \u001b[39mif\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_is_inferred:\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=361'>362</a>\u001b[0m     warnings\u001b[39m.\u001b[39mwarn(\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=362'>363</a>\u001b[0m         \u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39mThis \u001b[39m\u001b[39m{\u001b[39;00m\u001b[39mtype\u001b[39m(\u001b[39mself\u001b[39m)\u001b[39m}\u001b[39;00m\u001b[39m is an inferred schema that hasn\u001b[39m\u001b[39m'\u001b[39m\u001b[39mt been \u001b[39m\u001b[39m\"\u001b[39m\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=363'>364</a>\u001b[0m         \u001b[39m\"\u001b[39m\u001b[39mmodified. It\u001b[39m\u001b[39m'\u001b[39m\u001b[39ms recommended that you refine the schema \u001b[39m\u001b[39m\"\u001b[39m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=366'>367</a>\u001b[0m         \u001b[39mUserWarning\u001b[39;00m,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=367'>368</a>\u001b[0m     )\n\u001b[1;32m--> <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=369'>370</a>\u001b[0m \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mBACKEND\u001b[39m.\u001b[39;49mvalidate(\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=370'>371</a>\u001b[0m     check_obj,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=371'>372</a>\u001b[0m     schema\u001b[39m=\u001b[39;49m\u001b[39mself\u001b[39;49m,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=372'>373</a>\u001b[0m     head\u001b[39m=\u001b[39;49mhead,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=373'>374</a>\u001b[0m     tail\u001b[39m=\u001b[39;49mtail,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=374'>375</a>\u001b[0m     sample\u001b[39m=\u001b[39;49msample,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=375'>376</a>\u001b[0m     random_state\u001b[39m=\u001b[39;49mrandom_state,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=376'>377</a>\u001b[0m     lazy\u001b[39m=\u001b[39;49mlazy,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=377'>378</a>\u001b[0m     inplace\u001b[39m=\u001b[39;49minplace,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/container.py?line=378'>379</a>\u001b[0m )\n\nFile \u001b[1;32mc:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\backends\\pandas\\container.py:105\u001b[0m, in \u001b[0;36mDataFrameSchemaBackend.validate\u001b[1;34m(self, check_obj, schema, head, tail, sample, random_state, lazy, inplace)\u001b[0m\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=100'>101</a>\u001b[0m     \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mrun_schema_component_checks(\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=101'>102</a>\u001b[0m         check_obj_subsample, schema_components, lazy, error_handler\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=102'>103</a>\u001b[0m     )\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=103'>104</a>\u001b[0m \u001b[39mexcept\u001b[39;00m SchemaError \u001b[39mas\u001b[39;00m exc:\n\u001b[1;32m--> <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=104'>105</a>\u001b[0m     error_handler\u001b[39m.\u001b[39;49mcollect_error(exc\u001b[39m.\u001b[39;49mreason_code, exc)\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=106'>107</a>\u001b[0m \u001b[39mtry\u001b[39;00m:\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=107'>108</a>\u001b[0m     \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mrun_checks(check_obj_subsample, schema, error_handler)\n\nFile \u001b[1;32mc:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\error_handlers.py:37\u001b[0m, in \u001b[0;36mSchemaErrorHandler.collect_error\u001b[1;34m(self, reason_code, schema_error, original_exc)\u001b[0m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=30'>31</a>\u001b[0m \u001b[39m\u001b[39m\u001b[39m\"\"\"Collect schema error, raising exception if lazy is False.\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=31'>32</a>\u001b[0m \n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=32'>33</a>\u001b[0m \u001b[39m:param reason_code: string representing reason for error\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=33'>34</a>\u001b[0m \u001b[39m:param schema_error: ``SchemaError`` object.\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=34'>35</a>\u001b[0m \u001b[39m\"\"\"\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=35'>36</a>\u001b[0m \u001b[39mif\u001b[39;00m \u001b[39mnot\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_lazy:\n\u001b[1;32m---> <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=36'>37</a>\u001b[0m     \u001b[39mraise\u001b[39;00m schema_error \u001b[39mfrom\u001b[39;00m \u001b[39moriginal_exc\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=38'>39</a>\u001b[0m \u001b[39m# delete data of validated object from SchemaError object to prevent\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=39'>40</a>\u001b[0m \u001b[39m# storing copies of the validated DataFrame/Series for every\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=40'>41</a>\u001b[0m \u001b[39m# SchemaError collected.\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=41'>42</a>\u001b[0m \u001b[39mdel\u001b[39;00m schema_error\u001b[39m.\u001b[39mdata\n\nFile \u001b[1;32mc:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\backends\\pandas\\container.py:101\u001b[0m, in \u001b[0;36mDataFrameSchemaBackend.validate\u001b[1;34m(self, check_obj, schema, head, tail, sample, random_state, lazy, inplace)\u001b[0m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=96'>97</a>\u001b[0m check_obj_subsample \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39msubsample(\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=97'>98</a>\u001b[0m     check_obj, head, tail, sample, random_state\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=98'>99</a>\u001b[0m )\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=99'>100</a>\u001b[0m \u001b[39mtry\u001b[39;00m:\n\u001b[1;32m--> <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=100'>101</a>\u001b[0m     \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mrun_schema_component_checks(\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=101'>102</a>\u001b[0m         check_obj_subsample, schema_components, lazy, error_handler\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=102'>103</a>\u001b[0m     )\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=103'>104</a>\u001b[0m \u001b[39mexcept\u001b[39;00m SchemaError \u001b[39mas\u001b[39;00m exc:\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=104'>105</a>\u001b[0m     error_handler\u001b[39m.\u001b[39mcollect_error(exc\u001b[39m.\u001b[39mreason_code, exc)\n\nFile \u001b[1;32mc:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\backends\\pandas\\container.py:143\u001b[0m, in \u001b[0;36mDataFrameSchemaBackend.run_schema_component_checks\u001b[1;34m(self, check_obj, schema_components, lazy, error_handler)\u001b[0m\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=140'>141</a>\u001b[0m     check_results\u001b[39m.\u001b[39mappend(is_table(result))\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=141'>142</a>\u001b[0m \u001b[39mexcept\u001b[39;00m SchemaError \u001b[39mas\u001b[39;00m err:\n\u001b[1;32m--> <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=142'>143</a>\u001b[0m     error_handler\u001b[39m.\u001b[39;49mcollect_error(\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=143'>144</a>\u001b[0m         SchemaErrorReason\u001b[39m.\u001b[39;49mSCHEMA_COMPONENT_CHECK,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=144'>145</a>\u001b[0m         err,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=145'>146</a>\u001b[0m     )\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=146'>147</a>\u001b[0m \u001b[39mexcept\u001b[39;00m SchemaErrors \u001b[39mas\u001b[39;00m err:\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=147'>148</a>\u001b[0m     \u001b[39mfor\u001b[39;00m schema_error_dict \u001b[39min\u001b[39;00m err\u001b[39m.\u001b[39mschema_errors:\n\nFile \u001b[1;32mc:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\error_handlers.py:37\u001b[0m, in \u001b[0;36mSchemaErrorHandler.collect_error\u001b[1;34m(self, reason_code, schema_error, original_exc)\u001b[0m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=30'>31</a>\u001b[0m \u001b[39m\u001b[39m\u001b[39m\"\"\"Collect schema error, raising exception if lazy is False.\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=31'>32</a>\u001b[0m \n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=32'>33</a>\u001b[0m \u001b[39m:param reason_code: string representing reason for error\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=33'>34</a>\u001b[0m \u001b[39m:param schema_error: ``SchemaError`` object.\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=34'>35</a>\u001b[0m \u001b[39m\"\"\"\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=35'>36</a>\u001b[0m \u001b[39mif\u001b[39;00m \u001b[39mnot\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_lazy:\n\u001b[1;32m---> <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=36'>37</a>\u001b[0m     \u001b[39mraise\u001b[39;00m schema_error \u001b[39mfrom\u001b[39;00m \u001b[39moriginal_exc\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=38'>39</a>\u001b[0m \u001b[39m# delete data of validated object from SchemaError object to prevent\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=39'>40</a>\u001b[0m \u001b[39m# storing copies of the validated DataFrame/Series for every\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=40'>41</a>\u001b[0m \u001b[39m# SchemaError collected.\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=41'>42</a>\u001b[0m \u001b[39mdel\u001b[39;00m schema_error\u001b[39m.\u001b[39mdata\n\nFile \u001b[1;32mc:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\backends\\pandas\\container.py:138\u001b[0m, in \u001b[0;36mDataFrameSchemaBackend.run_schema_component_checks\u001b[1;34m(self, check_obj, schema_components, lazy, error_handler)\u001b[0m\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=135'>136</a>\u001b[0m \u001b[39mfor\u001b[39;00m schema_component \u001b[39min\u001b[39;00m schema_components:\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=136'>137</a>\u001b[0m     \u001b[39mtry\u001b[39;00m:\n\u001b[1;32m--> <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=137'>138</a>\u001b[0m         result \u001b[39m=\u001b[39m schema_component\u001b[39m.\u001b[39;49mvalidate(\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=138'>139</a>\u001b[0m             check_obj, lazy\u001b[39m=\u001b[39;49mlazy, inplace\u001b[39m=\u001b[39;49m\u001b[39mTrue\u001b[39;49;00m\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=139'>140</a>\u001b[0m         )\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=140'>141</a>\u001b[0m         check_results\u001b[39m.\u001b[39mappend(is_table(result))\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/container.py?line=141'>142</a>\u001b[0m     \u001b[39mexcept\u001b[39;00m SchemaError \u001b[39mas\u001b[39;00m err:\n\nFile \u001b[1;32mc:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\api\\pandas\\components.py:164\u001b[0m, in \u001b[0;36mColumn.validate\u001b[1;34m(self, check_obj, head, tail, sample, random_state, lazy, inplace)\u001b[0m\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=136'>137</a>\u001b[0m \u001b[39mdef\u001b[39;00m \u001b[39mvalidate\u001b[39m(\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=137'>138</a>\u001b[0m     \u001b[39mself\u001b[39m,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=138'>139</a>\u001b[0m     check_obj: pd\u001b[39m.\u001b[39mDataFrame,\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=144'>145</a>\u001b[0m     inplace: \u001b[39mbool\u001b[39m \u001b[39m=\u001b[39m \u001b[39mFalse\u001b[39;00m,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=145'>146</a>\u001b[0m ) \u001b[39m-\u001b[39m\u001b[39m>\u001b[39m pd\u001b[39m.\u001b[39mDataFrame:\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=146'>147</a>\u001b[0m \u001b[39m    \u001b[39m\u001b[39m\"\"\"Validate a Column in a DataFrame object.\u001b[39;00m\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=147'>148</a>\u001b[0m \n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=148'>149</a>\u001b[0m \u001b[39m    :param check_obj: pandas DataFrame to validate.\u001b[39;00m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=161'>162</a>\u001b[0m \u001b[39m    :returns: validated DataFrame.\u001b[39;00m\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=162'>163</a>\u001b[0m \u001b[39m    \"\"\"\u001b[39;00m\n\u001b[1;32m--> <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=163'>164</a>\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mBACKEND\u001b[39m.\u001b[39;49mvalidate(\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=164'>165</a>\u001b[0m         check_obj,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=165'>166</a>\u001b[0m         \u001b[39mself\u001b[39;49m,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=166'>167</a>\u001b[0m         head\u001b[39m=\u001b[39;49mhead,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=167'>168</a>\u001b[0m         tail\u001b[39m=\u001b[39;49mtail,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=168'>169</a>\u001b[0m         sample\u001b[39m=\u001b[39;49msample,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=169'>170</a>\u001b[0m         random_state\u001b[39m=\u001b[39;49mrandom_state,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=170'>171</a>\u001b[0m         lazy\u001b[39m=\u001b[39;49mlazy,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=171'>172</a>\u001b[0m         inplace\u001b[39m=\u001b[39;49minplace,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/api/pandas/components.py?line=172'>173</a>\u001b[0m     )\n\nFile \u001b[1;32mc:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\backends\\pandas\\components.py:94\u001b[0m, in \u001b[0;36mColumnBackend.validate\u001b[1;34m(self, check_obj, schema, head, tail, sample, random_state, lazy, inplace)\u001b[0m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=89'>90</a>\u001b[0m             validate_column(\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=90'>91</a>\u001b[0m                 check_obj[column_name]\u001b[39m.\u001b[39miloc[:, [i]], column_name\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=91'>92</a>\u001b[0m             )\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=92'>93</a>\u001b[0m     \u001b[39melse\u001b[39;00m:\n\u001b[1;32m---> <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=93'>94</a>\u001b[0m         validate_column(check_obj, column_name)\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=95'>96</a>\u001b[0m \u001b[39mif\u001b[39;00m lazy \u001b[39mand\u001b[39;00m error_handler\u001b[39m.\u001b[39mcollected_errors:\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=96'>97</a>\u001b[0m     \u001b[39mraise\u001b[39;00m SchemaErrors(\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=97'>98</a>\u001b[0m         schema\u001b[39m=\u001b[39mschema,\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=98'>99</a>\u001b[0m         schema_errors\u001b[39m=\u001b[39merror_handler\u001b[39m.\u001b[39mcollected_errors,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=99'>100</a>\u001b[0m         data\u001b[39m=\u001b[39mcheck_obj,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=100'>101</a>\u001b[0m     )\n\nFile \u001b[1;32mc:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\backends\\pandas\\components.py:72\u001b[0m, in \u001b[0;36mColumnBackend.validate.<locals>.validate_column\u001b[1;34m(check_obj, column_name)\u001b[0m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=67'>68</a>\u001b[0m         error_handler\u001b[39m.\u001b[39mcollect_error(\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=68'>69</a>\u001b[0m             err_dict[\u001b[39m\"\u001b[39m\u001b[39mreason_code\u001b[39m\u001b[39m\"\u001b[39m], err_dict[\u001b[39m\"\u001b[39m\u001b[39merror\u001b[39m\u001b[39m\"\u001b[39m]\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=69'>70</a>\u001b[0m         )\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=70'>71</a>\u001b[0m \u001b[39mexcept\u001b[39;00m SchemaError \u001b[39mas\u001b[39;00m err:\n\u001b[1;32m---> <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=71'>72</a>\u001b[0m     error_handler\u001b[39m.\u001b[39;49mcollect_error(err\u001b[39m.\u001b[39;49mreason_code, err)\n\nFile \u001b[1;32mc:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\error_handlers.py:37\u001b[0m, in \u001b[0;36mSchemaErrorHandler.collect_error\u001b[1;34m(self, reason_code, schema_error, original_exc)\u001b[0m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=30'>31</a>\u001b[0m \u001b[39m\u001b[39m\u001b[39m\"\"\"Collect schema error, raising exception if lazy is False.\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=31'>32</a>\u001b[0m \n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=32'>33</a>\u001b[0m \u001b[39m:param reason_code: string representing reason for error\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=33'>34</a>\u001b[0m \u001b[39m:param schema_error: ``SchemaError`` object.\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=34'>35</a>\u001b[0m \u001b[39m\"\"\"\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=35'>36</a>\u001b[0m \u001b[39mif\u001b[39;00m \u001b[39mnot\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_lazy:\n\u001b[1;32m---> <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=36'>37</a>\u001b[0m     \u001b[39mraise\u001b[39;00m schema_error \u001b[39mfrom\u001b[39;00m \u001b[39moriginal_exc\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=38'>39</a>\u001b[0m \u001b[39m# delete data of validated object from SchemaError object to prevent\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=39'>40</a>\u001b[0m \u001b[39m# storing copies of the validated DataFrame/Series for every\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=40'>41</a>\u001b[0m \u001b[39m# SchemaError collected.\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=41'>42</a>\u001b[0m \u001b[39mdel\u001b[39;00m schema_error\u001b[39m.\u001b[39mdata\n\nFile \u001b[1;32mc:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\backends\\pandas\\components.py:56\u001b[0m, in \u001b[0;36mColumnBackend.validate.<locals>.validate_column\u001b[1;34m(check_obj, column_name)\u001b[0m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=52'>53</a>\u001b[0m \u001b[39mdef\u001b[39;00m \u001b[39mvalidate_column\u001b[39m(check_obj, column_name):\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=53'>54</a>\u001b[0m     \u001b[39mtry\u001b[39;00m:\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=54'>55</a>\u001b[0m         \u001b[39m# pylint: disable=super-with-arguments\u001b[39;00m\n\u001b[1;32m---> <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=55'>56</a>\u001b[0m         \u001b[39msuper\u001b[39;49m(ColumnBackend, \u001b[39mself\u001b[39;49m)\u001b[39m.\u001b[39;49mvalidate(\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=56'>57</a>\u001b[0m             check_obj,\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=57'>58</a>\u001b[0m             copy(schema)\u001b[39m.\u001b[39;49mset_name(column_name),\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=58'>59</a>\u001b[0m             head\u001b[39m=\u001b[39;49mhead,\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=59'>60</a>\u001b[0m             tail\u001b[39m=\u001b[39;49mtail,\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=60'>61</a>\u001b[0m             sample\u001b[39m=\u001b[39;49msample,\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=61'>62</a>\u001b[0m             random_state\u001b[39m=\u001b[39;49mrandom_state,\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=62'>63</a>\u001b[0m             lazy\u001b[39m=\u001b[39;49mlazy,\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=63'>64</a>\u001b[0m             inplace\u001b[39m=\u001b[39;49minplace,\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=64'>65</a>\u001b[0m         )\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=65'>66</a>\u001b[0m     \u001b[39mexcept\u001b[39;00m SchemaErrors \u001b[39mas\u001b[39;00m err:\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=66'>67</a>\u001b[0m         \u001b[39mfor\u001b[39;00m err_dict \u001b[39min\u001b[39;00m err\u001b[39m.\u001b[39mschema_errors:\n\nFile \u001b[1;32mc:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\backends\\pandas\\array.py:103\u001b[0m, in \u001b[0;36mArraySchemaBackend.validate\u001b[1;34m(self, check_obj, schema, head, tail, sample, random_state, lazy, inplace)\u001b[0m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/array.py?line=89'>90</a>\u001b[0m     \u001b[39mif\u001b[39;00m \u001b[39mnot\u001b[39;00m check_result\u001b[39m.\u001b[39mpassed:\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/array.py?line=90'>91</a>\u001b[0m         error_handler\u001b[39m.\u001b[39mcollect_error(\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/array.py?line=91'>92</a>\u001b[0m             check_result\u001b[39m.\u001b[39mreason_code,\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/array.py?line=92'>93</a>\u001b[0m             SchemaError(\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/array.py?line=99'>100</a>\u001b[0m             ),\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/array.py?line=100'>101</a>\u001b[0m         )\n\u001b[1;32m--> <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/array.py?line=102'>103</a>\u001b[0m check_results \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mrun_checks(\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/array.py?line=103'>104</a>\u001b[0m     check_obj_subsample, schema, error_handler, lazy\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/array.py?line=104'>105</a>\u001b[0m )\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/array.py?line=105'>106</a>\u001b[0m \u001b[39massert\u001b[39;00m \u001b[39mall\u001b[39m(check_results)\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/array.py?line=107'>108</a>\u001b[0m \u001b[39mif\u001b[39;00m lazy \u001b[39mand\u001b[39;00m error_handler\u001b[39m.\u001b[39mcollected_errors:\n\nFile \u001b[1;32mc:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\backends\\pandas\\components.py:204\u001b[0m, in \u001b[0;36mColumnBackend.run_checks\u001b[1;34m(self, check_obj, schema, error_handler, lazy)\u001b[0m\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=201'>202</a>\u001b[0m         err_msg \u001b[39m=\u001b[39m \u001b[39mf\u001b[39m\u001b[39m'\u001b[39m\u001b[39m\"\u001b[39m\u001b[39m{\u001b[39;00merr\u001b[39m.\u001b[39margs[\u001b[39m0\u001b[39m]\u001b[39m}\u001b[39;00m\u001b[39m\"\u001b[39m\u001b[39m'\u001b[39m \u001b[39mif\u001b[39;00m \u001b[39mlen\u001b[39m(err\u001b[39m.\u001b[39margs) \u001b[39m>\u001b[39m \u001b[39m0\u001b[39m \u001b[39melse\u001b[39;00m \u001b[39m\"\u001b[39m\u001b[39m\"\u001b[39m\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=202'>203</a>\u001b[0m         err_str \u001b[39m=\u001b[39m \u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39m{\u001b[39;00merr\u001b[39m.\u001b[39m\u001b[39m__class__\u001b[39m\u001b[39m.\u001b[39m\u001b[39m__name__\u001b[39m\u001b[39m}\u001b[39;00m\u001b[39m(\u001b[39m\u001b[39m{\u001b[39;00m\u001b[39m \u001b[39merr_msg\u001b[39m}\u001b[39;00m\u001b[39m)\u001b[39m\u001b[39m\"\u001b[39m\n\u001b[1;32m--> <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=203'>204</a>\u001b[0m         error_handler\u001b[39m.\u001b[39;49mcollect_error(\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=204'>205</a>\u001b[0m             SchemaErrorReason\u001b[39m.\u001b[39;49mCHECK_ERROR,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=205'>206</a>\u001b[0m             SchemaError(\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=206'>207</a>\u001b[0m                 schema\u001b[39m=\u001b[39;49mschema,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=207'>208</a>\u001b[0m                 data\u001b[39m=\u001b[39;49mcheck_obj,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=208'>209</a>\u001b[0m                 message\u001b[39m=\u001b[39;49m(\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=209'>210</a>\u001b[0m                     \u001b[39mf\u001b[39;49m\u001b[39m\"\u001b[39;49m\u001b[39mError while executing check function: \u001b[39;49m\u001b[39m{\u001b[39;49;00merr_str\u001b[39m}\u001b[39;49;00m\u001b[39m\\n\u001b[39;49;00m\u001b[39m\"\u001b[39;49m\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=210'>211</a>\u001b[0m                     \u001b[39m+\u001b[39;49m traceback\u001b[39m.\u001b[39;49mformat_exc()\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=211'>212</a>\u001b[0m                 ),\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=212'>213</a>\u001b[0m                 failure_cases\u001b[39m=\u001b[39;49mscalar_failure_case(err_str),\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=213'>214</a>\u001b[0m                 check\u001b[39m=\u001b[39;49mcheck,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=214'>215</a>\u001b[0m                 check_index\u001b[39m=\u001b[39;49mcheck_index,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=215'>216</a>\u001b[0m             ),\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=216'>217</a>\u001b[0m             original_exc\u001b[39m=\u001b[39;49merr,\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=217'>218</a>\u001b[0m         )\n\u001b[0;32m    <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/backends/pandas/components.py?line=218'>219</a>\u001b[0m \u001b[39mreturn\u001b[39;00m check_results\n\nFile \u001b[1;32mc:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\error_handlers.py:37\u001b[0m, in \u001b[0;36mSchemaErrorHandler.collect_error\u001b[1;34m(self, reason_code, schema_error, original_exc)\u001b[0m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=30'>31</a>\u001b[0m \u001b[39m\u001b[39m\u001b[39m\"\"\"Collect schema error, raising exception if lazy is False.\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=31'>32</a>\u001b[0m \n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=32'>33</a>\u001b[0m \u001b[39m:param reason_code: string representing reason for error\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=33'>34</a>\u001b[0m \u001b[39m:param schema_error: ``SchemaError`` object.\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=34'>35</a>\u001b[0m \u001b[39m\"\"\"\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=35'>36</a>\u001b[0m \u001b[39mif\u001b[39;00m \u001b[39mnot\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_lazy:\n\u001b[1;32m---> <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=36'>37</a>\u001b[0m     \u001b[39mraise\u001b[39;00m schema_error \u001b[39mfrom\u001b[39;00m \u001b[39moriginal_exc\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=38'>39</a>\u001b[0m \u001b[39m# delete data of validated object from SchemaError object to prevent\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=39'>40</a>\u001b[0m \u001b[39m# storing copies of the validated DataFrame/Series for every\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=40'>41</a>\u001b[0m \u001b[39m# SchemaError collected.\u001b[39;00m\n\u001b[0;32m     <a href='file:///c%3A/Users/hessm/miniconda3/envs/classifier_dev/lib/site-packages/pandera/error_handlers.py?line=41'>42</a>\u001b[0m \u001b[39mdel\u001b[39;00m schema_error\u001b[39m.\u001b[39mdata\n\n\u001b[1;31mSchemaError\u001b[0m: Error while executing check function: TypeError(\"boolean value of NA is ambiguous\")\nTraceback (most recent call last):\n  File \"c:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\backends\\pandas\\components.py\", line 191, in run_checks\n    self.run_check(\n  File \"c:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\backends\\pandas\\base.py\", line 95, in run_check\n    check_result = check(check_obj, *args)\n  File \"c:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\api\\checks.py\", line 230, in __call__\n    return backend(check_obj, column)\n  File \"c:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\backends\\pandas\\checks.py\", line 290, in __call__\n    check_output = self.apply(check_obj)\n  File \"c:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\multimethod\\__init__.py\", line 407, in __call__\n    return self[sig](*args, **kwargs)\n  File \"c:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandera\\backends\\pandas\\checks.py\", line 137, in apply\n    return check_obj.map(self.check_fn)\n  File \"c:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandas\\core\\series.py\", line 4539, in map\n    new_values = self._map_values(arg, na_action=na_action)\n  File \"c:\\Users\\hessm\\miniconda3\\envs\\classifier_dev\\lib\\site-packages\\pandas\\core\\base.py\", line 890, in _map_values\n    new_values = map_f(values, mapper)\n  File \"pandas\\_libs\\lib.pyx\", line 2924, in pandas._libs.lib.map_infer\n  File \"<ipython-input-2-33bc2c2059b3>\", line 17, in <lambda>\n    lambda x: 1 <= x <= len(class_names),\n  File \"pandas\\_libs\\missing.pyx\", line 382, in pandas._libs.missing.NAType.__bool__\nTypeError: boolean value of NA is ambiguous\n",
}


# %%
feature_names = ["feature1", "feature2", "feature3"]
input_schema = get_input_schema(feature_names)
schema = input_schema.set_index(["roi_id", "label"])
# %%
input_schema.validate(df.reset_index().reset_index())

# %%
schema = pa.DataFrameSchema(
    columns={
        "feature1": pa.Column(pa.Float32, coerce=True),
        "feature2": pa.Column(pa.Float32, coerce=True),
    },
    index=pa.MultiIndex(
        [
            pa.Index(pa.String, name="idx1", coerce=True),
            pa.Index(pa.Int64, name="idx2", coerce=True),
        ]
    ),
)

df = pd.DataFrame(
    data={
        "idx1": ["a", "b", "c"],
        "idx2": [0, 1, 2],
        "feature1": [1.0, 2.0, 3.0],
        "feature2": [4.0, 5.0, 6.0],
    }
).set_index(["idx1", "idx2"])

df_valid = schema.validate(df)

df_example = schema.example(3)
